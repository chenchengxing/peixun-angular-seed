tinymce.PluginManager.add('upload', function(editor, url) {
    // Add a button that opens a window
    editor.addButton('upload', {
        text: '插入图片',
        icon: 'image',
        onclick: function() {
            // Open window
            editor.windowManager.open({
                title: '插入图片',
                url: 'upload.jsp',
                width: 600
                // height: 300,
                // onsubmit: function(e) {
                //     // Insert content when the window form is submitted
                //     editor.insertContent('Title: ' + '<img src="http://bcscdn.baidu.com/peixuncourse%2FcourseResource%2Fcourse%2Fcover%2F13853727818073059758%2FcourseCover.jpg?sign=MBO%3ADdAwfjdWB9URJw1OTx8Y6Feu%3A0%2FDgLHZwixxMN%2FeXH5igPG%2BTluw%3D">');
                //     // console.log(tinyMCE.get('pp').getContent())
                // },

                // buttons: [{
                //     text: '确定',
                //     onclick: function () {
                        
                //         // editor.insertContent('Tit');
                //         // Close the front most window (mydialog.html)
                //         top.tinymce.activeEditor.windowManager.close();
                //     }
                // }]
            },
            {
                editor : editor
                // ,
                // windowManager : top.tinymce.activeEditor.windowManager
            });
        }
    });

    // Adds a menu item to the tools menu
    editor.addMenuItem('upload', {
        text: 'upload plugin',
        context: 'tools',
        onclick: function() {
            // Open window with a specific url
            editor.windowManager.open({
                title: 'TinyMCE site',
                url: 'http://www.tinymce.com',
                width: 800,
                height: 600,
                buttons: [{
                    text: 'Close',
                    onclick: 'close'
                }]
            });
        }
    });
});